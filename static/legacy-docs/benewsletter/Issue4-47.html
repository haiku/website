<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Be Newsletters - Volume 4: 1999</title><link rel="stylesheet" href="be_newsletter.css" type="text/css" media="all" /><link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./images/favicon.ico" /><!--[if IE]>
    <link rel="stylesheet" type="text/css" href="be_newsletter_ie.css" />
    <![endif]--><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Be Newsletters" /><link rel="up" href="volume4.html" title="Volume 4: 1999" /><link rel="prev" href="Issue4-46.html" title="Issue 4-46, November 17, 1999" /><link rel="next" href="Issue4-48.html" title="Issue 4-48, December 1, 1999" /></head><body><div id="header"><div id="headerT"><div id="headerTL"><a accesskey="p" href="Issue4-46.html" title="Issue 4-46, November 17, 1999"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a accesskey="u" href="volume4.html" title="Volume 4: 1999"><img src="./images/navigation/up.png" alt="Up" /></a> <a accesskey="n" href="Issue4-48.html" title="Issue 4-48, December 1, 1999"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="headerTR"><div id="navigpeople"><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div><div class="navigboxed" id="naviglang" title="English">en</div></div><div id="headerTC">Be Newsletters - Volume 4: 1999</div></div><div id="headerB">Prev: <a href="Issue4-46.html">Issue 4-46, November 17, 1999</a>  Up: <a href="volume4.html">Volume 4: 1999</a>  Next: <a href="Issue4-48.html">Issue 4-48, December 1, 1999</a></div><hr /></div><div class="article"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Issue4-47"></a>Issue 4-47, November 24, 1999</h2></div></div></div><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Engineering4-47"></a>Be Engineering Insights: Motor Mixin'</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Douglas</span> <span class="surname">Wright</span></span></div></div></div><p>
The new Midi Kit in the upcoming Maui release of BeOS provides more
flexible interconnection of Midi objects, while remaining backward
compatible with the old Midi Kit. We chose not to integrate the Midi Kit
into the Media Kit as another media type, mainly because MIDI doesn't
require any of the format negotiation that other media types need. We did
put a familiar face on the new Midi Kit, though. There's a MidiRoster for
finding or registering <code class="classname">BMidiConsumer</code>s and <code class="classname">BMidiProducer</code>s, but without
multiple virtual inheritance this time. That means you can't create an
object that's both a <code class="classname">BMidiConsumer</code> and a <code class="classname">BMidiProducer</code>. Also, rather than
use token structs like media node to make connections via the
MediaRoster, the new kit makes the connections directly via the
<code class="classname">BMidiProducer</code> object. And timing in the new kit is in microseconds
instead of milliseconds.
</p><p>
My favorite application of MIDI is real-time control. I've written a
class that does all the dirty work of sending the right messages to a
cool new controller, as an example of how you can use the new MIDI Kit.
You'll find the code here soon:
</p><p>
&lt;ftp://ftp.be.com/pub/samples/midi kit/motormix.zip&gt;
</p><p>
The Motor Mix is a MIDI controller from CM Automation
&lt;http://www.cmautomation.com/&gt; that has channel strips with motorized
100mm faders, 5 buttons with LEDs, and a continuous pot controller. It
also has a two-character-high LCD for a "scribble strip" and for
indicating the positions of the pots and a few dozen other function keys.
It was designed to be integrated into audio applications as a more
natural control surface for audio mixing applications. The Motor Mix uses
MIDI as its communication method, sending and receiving continuous
controller messages for each slider and switch that is manipulated. If
you're developing an audio application and would like the Motor Mix to be
fully integrated into it, please contact Pete Montessi at CM Automation
for more information.
</p><p>
The sample code includes an object that represents a Motor Mix controller
that you can use in your apps. The class contains both <code class="classname">BMidiConsumer</code> and
<code class="classname">BMidiProducer</code> objects that it uses to send and receive MIDI data to the
controller. It also manages the connection with the consumer and producer
that represent the Midi device. The app needs to supply the appropriate
Midi device to connect to. The <code class="classname">MotorMix</code> class has functions to move the
faders, set the state of the LEDs in the switches, and set the characters
in the display. To receive messages from the Motor Mix, you have two
options. You can subclass the <code class="classname">MotorMix</code> object and override the hook
functions for each message, or you can call SetMessenger with a
<code class="classname">BMessenger</code> pointed at the handler that you want to receive the messages.
As an example, I've created a window with controls laid out just like a
motor mix that mimic the current state of the controller.
</p></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="DevWorkshop4-47"></a>Developers' Workshop: The BeOS Memory Map</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Daniel</span> <span class="surname">Switkin</span></span></div></div></div><p>
In an effort to make your debugging life easier, I thought I'd write an
article documenting the BeOS memory map. Knowing where things get loaded
can be pretty helpful when reading stack crawls, using the leak checker,
and <code class="function">printf()</code>'ing pointers.
</p><p>
As you've probably heard, BeOS uses protected memory. What that means is
every app has its own 32-bit virtual address space (about 4 billion
bytes), and cannot directly view memory from the system or other apps.
For example, a given location in my app (let's say <code class="literal">0x80002000</code>) does not
contain the same data as the same address in another app's address space.
This is why you can't pass meaningful pointers between applications, and
why one badly behaved program can't trash the memory of others.
</p><p>
BeOS R4.5 places data in memory as follows. I want to emphasize that this
is how the current release behaves, and while we don't have short term
plans to change it, these locations are not written in stone:
</p><pre class="screen">
0x00000000 - kernel
0x80000000 - application code
heap follows code
0xea000000 - addons
0xec000000 - libraries
0xfc000000 - stack
</pre><p>
In addition, you might have:
</p><pre class="screen">
0xd0000000 - app server shared data
0xa0000000 - net server shared data
</pre><p>
Let's go through these in turn.
</p><p>
Memory between 0 and 8 bazillions, as they are lovingly referred to, does
not belong to your app. If you try to touch it directly, you'll get a
segmentation fault at almost any address:
</p><pre class="programlisting c">
<span class="type">int</span> <code class="function">main</code>(<span class="type">int</span> <code class="parameter">argc</code>, <span class="type">char **</span><code class="parameter">argv</code>) {
         <span class="type">char *</span><code class="varname">p</code> = (<span class="type">char *</span>)0x70000000;
         *<code class="varname">p</code> = 'a';
}
</pre><p>
This range of memory is set aside for times when the OS needs to map data
into your address space. This happens when writing directly to the frame
buffer, for instance. These locations may be in existence before you
explicitly request them, but you should never try to guess where they
live.
</p><p>
The lower half of the address space also contains everything used by the
kernel, including kernel code, kernel data, kernel heap, driver code,
disk and loader cache, physical memory, and various buffers needed to
communicate with the hardware. The reason why the whole kernel is always
mapped is that this allows you to enter the kernel without doing a
context switch (you just need to switch the protection level).
</p><p>
At 8 bazillions, your application's code and data lives. When using the
<code class="command">listarea</code> command, these are referred to as <code class="literal">seg0</code> and <code class="literal">seg1</code>, respectively.
The heap, where dynamically allocated memory lives, immediately follows
the data segment.
</p><p>
Add-ons are loaded at <code class="literal">0xea000000</code>. You'll find translators, <span class="application">Tracker</span>
add-ons (if you're examining <span class="application">Tracker</span> memory), and so forth here. Note
that because they run in your app's team and memory space, misbehaved
add-ons can crash your application.
</p><p>
Libraries are loaded at <code class="literal">0xec000000</code>.
<code class="filename">libnet.so</code> and <code class="filename">libroot.so</code> will always
be present, in order to give basic functionality and to ease recompiling
of UNIX programs. In addition, you'll typically link against <code class="filename">libbe.so</code> and
others.
</p><p>
The stacks for your various threads live at <code class="literal">0xfc000000</code>. In R4.5, the main
thread has 2 megabytes of stack, while other threads have 256k. In the
next version of BeOS, the main thread will have 16 megabytes of room,
which is needed for demanding applications like <span class="application">gcc</span>.
</p><p>
If your application contains a <code class="classname">BApplication</code>, as most do, you'll also have
some data mapped in from your connection to the app server, at
<code class="literal">0xd0000000</code>. This code
</p><pre class="programlisting c">
#include &lt;Application.h&gt;
#include &lt;Bitmap.h&gt;
#include &lt;stdio.h&gt;

<span class="type">int</span> <code class="function">main</code>(<span class="type">int</span> <code class="parameter">argc</code>, <span class="type">char **</span><code class="parameter">argv</code>) {
         <code class="classname">BApplication</code> <code class="varname">app</code>("application/x-vnd.BeDTS-BitmapTest");
         <code class="classname">BRect</code> <code class="varname">rect</code>(0, 0, 639, 479);
         <span class="type"><code class="classname">BBitmap</code> *</span><code class="varname">bitmap</code> = new <code class="classname">BBitmap</code>(<code class="varname">rect</code>, <code class="constant">B_RGB32</code>);
         <span class="type">uchar *</span>bits = (<span class="type">uchar *</span>)bitmap-&gt;Bits();
         <code class="function">printf</code>("Bitmap at %p, bits at %p\n", <code class="varname">bitmap</code>, <code class="varname">bits</code>);
         delete <code class="varname">bitmap</code>;
         return 0;
}
</pre><p>
gives this:
</p><pre class="screen">
Bitmap at 0x80009a80, bits at 0xd0000440
</pre><p>
Notice that the bitmap object, being new'ed, lives on the heap, whereas
the image data itself is in rw server area. There are also read only and
global read only regions of memory from the app server which contain
things like the system palette.
</p><p>
Lastly, you'll find net server memory located at <code class="literal">0xa0000000</code>. Information
about your sockets and the buffers received by the net server itself
reside here.
</p></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Gassee4-47"></a>Giving Thanks...for a Great Comdex</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Jean-Louis</span> <span class="surname">Gassée</span></span></div></div></div><p>
The clichés are familiar: Comdex is terrible, crowded, tasteless,
useless; Las Vegas is terrible, crowded, tasteless, etc. And the portions
are too big. There must be some truth in the litany when cab drivers (one
a very knowledgeable and articulate former Intel employee) complain that
attendance is down by more than 10%.
</p><p>
Attendance at the Be booth in the Sands did not reflect the slump,
however. This year, more than ever before, the crowd spilled over into
the aisles and the booth opposite ours. Comdex organizers came and
admonished us to control the situation. We apologized profusely and tried
to keep the aisles and the neighboring booth clear. For next year, we've
reserved a larger, more conveniently located booth, and we'll make more
room for the audience.
</p><p>
We demo'ed BeOS in both desktop and Web appliance applications. We showed
the first public demonstration of the National Semiconductor WebPAD
running BeOS. The 2.4 Ghz wireless Ethernet served the tablet form factor
well; visitor reactions confirm that this is a promising direction.
Combine instant-on, broadband connectivity; seductive multimedia
performance; and extemporaneous, untethered Web navigation—and you
have a user experience that's attractive to hard core technophiles and
reluctant technophobes alike.
</p><p>
Of course, we felt "validated" when Bill Gates decreed Web appliances
official. A little nervous, too, because, once again, we're competing on
a field that Microsoft is targeting. No real surprise, but a reminder of
the giant's known appetite.
</p><p>
Because of our IPO's all-consuming schedule, I hadn't seen Jerry
Basserman in action at PC Expo. I had seen him in another capacity,
celebrating a wedding—not in Las Vegas, I'll hasten to add. At Comdex,
on more mundane matters of operating systems and applications, he was no
less evangelistic. He led the crowd through a review of BeOS features and
applications such as Moho, Gobe, Easel, 3dmiX, and personalStudio. For a
finale, he literally pulled the plug to prove the robustness of the file
system and the boot speed.
</p><p>
But there was more to our booth and our demos than larger, enthusiastic
crowds in a less-attended than usual Comdex. There was more than a
growing number of applications, or visitors telling others, as I
overheard: "See, that's what I've been using for over a year...." What's
new this time is a different sense of possibilities. In the past, I've
often heard: "Cool demo, but...." I'll let you finish the sentence. This
year, for reasons ranging from progress on our product and applications
to a possible power shift in the industry and to the emerging wave of
Internet appliance applications for BeOS, there's a sense that
alternative OSes have an important role in the future of our industry.
</p><p>
That said, we still have a lot to do and a lot to prove. I'll conclude by
giving thanks to all who made this successful Comdex possible, from
application developers, to contractors, to the many individuals at Be who
organized and performed so competently. Happy Thanksgiving!
</p></div></div><div id="footer"><hr /><div id="footerT">Prev: <a href="Issue4-46.html">Issue 4-46, November 17, 1999</a>  Up: <a href="volume4.html">Volume 4: 1999</a>  Next: <a href="Issue4-48.html">Issue 4-48, December 1, 1999</a> </div><div id="footerB"><div id="footerBL"><a href="Issue4-46.html" title="Issue 4-46, November 17, 1999"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a href="volume4.html" title="Volume 4: 1999"><img src="./images/navigation/up.png" alt="Up" /></a> <a href="Issue4-48.html" title="Issue 4-48, December 1, 1999"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="footerBR"><div><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div></div><div id="footerBC"><a href="http://www.access-company.com/home.html" title="ACCESS Co."><img alt="Access Company" src="./images/access_logo.png" /></a></div></div></div><div id="licenseFooter"><div id="licenseFooterBL"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="Creative Commons License"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a></div><div id="licenseFooterBR"><a href="./LegalNotice.html">Legal Notice</a></div><div id="licenseFooterBC"><span id="licenseText">This work is licensed under a
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative
          Commons Attribution-Non commercial-No Derivative Works 3.0 License</a>.</span></div></div></body></html>
