<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Be Newsletters - Volume 2: 1997</title><link rel="stylesheet" href="be_newsletter.css" type="text/css" media="all" /><link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./images/favicon.ico" /><!--[if IE]>
    <link rel="stylesheet" type="text/css" href="be_newsletter_ie.css" />
    <![endif]--><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Be Newsletters" /><link rel="up" href="volume2.html" title="Volume 2: 1997" /><link rel="prev" href="Issue2-27.html" title="Issue 2-27, July 9, 1997" /><link rel="next" href="Issue2-29.html" title="Issue 2-29, July 23, 1997" /></head><body><div id="header"><div id="headerT"><div id="headerTL"><a accesskey="p" href="Issue2-27.html" title="Issue 2-27, July 9, 1997"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a accesskey="u" href="volume2.html" title="Volume 2: 1997"><img src="./images/navigation/up.png" alt="Up" /></a> <a accesskey="n" href="Issue2-29.html" title="Issue 2-29, July 23, 1997"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="headerTR"><div id="navigpeople"><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div><div class="navigboxed" id="naviglang" title="English">en</div></div><div id="headerTC">Be Newsletters - Volume 2: 1997</div></div><div id="headerB">Prev: <a href="Issue2-27.html">Issue 2-27, July 9, 1997</a>  Up: <a href="volume2.html">Volume 2: 1997</a>  Next: <a href="Issue2-29.html">Issue 2-29, July 23, 1997</a></div><hr /></div><div class="article"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Issue2-28"></a>Issue 2-28, July 16, 1997</h2></div></div></div><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Engineering2-28"></a>Be Engineering Insights: Shared Librairies And Add-Ons</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Cyril</span> <span class="surname">Meurillon</span></span></div></div></div><p>
When you write an application, you depend on the API that's provided by
the OS. But how and where does your application find the code that
corresponds to a particular function call? There are two vehicles for
collecting "common" code that different applications can use: a) shared
libraries and b) add-ons. This article looks at the features of and
differences between shared libraries and add-ons.
</p><p>
Shared libraries are binaries that contain code and data that can be used
by any application. For example, in
<code class="filename">/boot/beos/system/lib</code>, you'll find
the "system libraries," i.e., the libraries provided by Be and used by
most applications. They contain the code for the standard kits, such as
the Interface Kit, the Storage Kit, the Application Kit, and so on.
</p><p>
Developers can also create their own shared libraries. This can prove
particularly useful if you're developing a line of applications that
share some amount of code. The common code is put into a shared library
that the "client" applications can link against. Some developers may even
find a market in developing shared libraries that they can sell to other
developers as API extensions.
</p><p>
Structurally, add-ons are identical to shared libraries. The difference
between libraries and add-ons is how they're used:
</p><ul class="itemizedlist"><li><p>
Applications identify the libraries they need at compile time, and
link against the libraries at load time. When you launch an
application, the application's code and that of all the libraries that
it needs are loaded.
</p></li><li><p>
Add-ons, on the other hand, are identified and loaded by the
application at run time. The dependency is completely dynamic, as the
application can decide on the fly which add-on to load. There are
functions to load an add-on, to unload it, to look for a specific
symbol (function or data item), or browse through all the symbols of
the add-on. This allows any application to dynamically load and unload
code that's defined by the add-on.
</p></li></ul><p>
Looking for and using add-ons is very useful if you want to allow
"extensions" to your program.
</p><p>
Many BeOS applications rely on add-ons: The Tracker, for example, allows
its add-ons to operate on the set of selected files through a defined
API. The add-on only needs to have a function process_refs(), which is
invoked on the selection passed as a BMessage. This architecture makes
the Tracker customizable. Rraster uses the same technology to identify
and parse different picture formats—the format recognition isn't in
Rraster itself, but in the add-ons that it loads. Adding support for
another picture format simply consists of writing an add-on that can
decipher that format and complies with Rraster. Another use of add-ons is
in the kernel with loadable drivers and file-systems.
</p><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id573407"></a>A Shared Library Example</h3></div></div></div><p>
Launch the IDE and create a project <code class="filename">squarer.proj</code>
that contains <code class="filename">squarer.c</code>
as its only source file. Change the project settings the following way:
</p><ul class="itemizedlist"><li><p>
set the project type to "Shared Library"
</p></li><li><p>
set the file name to "squarer" (under "PPC project")
</p></li><li><p>
remove __start as the "Main" entry point (under "Linker")
</p></li><li><p>
set "use #pragma" (under "PEF")
</p></li></ul><p>
You can then make the shared library.
</p><p>
<code class="filename">squarer.c</code>: (the shared library)
</p><pre class="programlisting c">
extern "C" <span class="type">int</span> <code class="function">squarer</code>(<span class="type">int</span>);

#pragma export on
<span class="type">int</span>  <code class="function">squarer</code>(<span class="type">int</span> <code class="parameter">x</code>)
{
  return <code class="parameter">x</code>*<code class="parameter">x</code>;
}
#pragma export off
</pre><p>
The <code class="code">#pragma</code> primitive tells the linker which symbols to export from the
shared library. Without it, the function <code class="function">squarer()</code> would be invisible
from the executable. Also, <code class="function">squarer()</code> is declared as
<code class="code">extern C</code> to avoid C++ name mangling.
</p><p>
Now create another project for the application that's going to call
<code class="function">squarer()</code>. This one takes the default project settings. Add
<code class="filename">main.c</code> and
the shared library squarer to the project, and make your application.
</p><p>
<code class="filename">main.c</code>: (the executable that links against the shared library)
</p><pre class="programlisting c">
#include &lt;stdio.h&gt;

extern "C" <span class="type">int</span> <code class="function">squarer</code>(<span class="type">int</span>);

<span class="type">int</span> <code class="function">main</code>(<span class="type">int</span> <code class="parameter">argc</code>, <span class="type">char **</span><code class="parameter">argv</code>)
{
  <span class="type">int</span>    <code class="varname">n</code>;

  <code class="varname">n</code> = <code class="function">squarer</code>(5);
  <code class="function">printf</code>("&gt; squarer(5) = %d\n", <code class="varname">n</code>);
}
</pre><p>
In the &lt;app_dir&gt; (i.e., the directory that the application lives in),
create a directory named <code class="filename">lib</code> and
copy "squarer" into it. The kernel
loader automatically looks in <code class="filename">&lt;app_dir&gt;/lib</code>
for shared libraries (in
addition to looking in the system-defined library directories).
</p><p>
Launch the application from the shell, and you'll see the expected result
</p><pre class="screen">
$ squarer
&gt; squarer(5) = 25
</pre><p>
"Very good," you think, "but <span class="foreignphrase"><em class="foreignphrase">je suis
francais</em></span>—I want to use her as an
add-on!"
</p></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id573647"></a>Add-On Example</h3></div></div></div><p>
Shared libraries and add-ons are built exactly the same way (remember,
they're structurally identical). So we don't have to do anything
different to build "squarer". "squarer" does not change, but the way the
function <code class="function">squarer()</code> is invoked does.
</p><p>
Here's the new version of <code class="filename">main.c</code>:
</p><pre class="programlisting c">
#include &lt;stdio.h&gt;
#include &lt;image.h&gt;

<span class="type">int</span> <code class="function">main</code>(<span class="type">int</span> <code class="parameter">argc</code>, <span class="type">char **</span><code class="parameter">argv</code>)
{
  <span class="type">int</span> <code class="varname">n</code>;
  <span class="type">int</span> (*<code class="varname">squarer</code>)(<span class="type">int</span>);
  <span class="type">image_id</span> <code class="varname">aoid</code>;

  <code class="varname">aoid</code> = <code class="function">load_add_on</code>("squarer");
  if (<code class="varname">aoid</code> &lt; 0) {
    <code class="function">printf</code>("problems loading the add-on\n");
    return 1;
  }
  if (<code class="function">get_image_symbol</code>(<code class="varname">aoid</code>, "squarer",
        <code class="constant">B_SYMBOL_TYPE_TEXT</code>, &amp;<code class="varname">squarer</code>)) {
    <code class="function">printf</code>("problems finding symbol 'squarer'\n");
    return 1;
  }

  <code class="varname">n</code> = (*<code class="varname">squarer</code>)(5);
  <code class="function">printf</code>("squarer(5) = %d\n", <code class="varname">n</code>);

  <code class="function">unload_add_on</code>(<code class="varname">aoid</code>);
}
</pre><p>
The code is pretty much self-explanatory. <code class="function">get_image_symbol()</code> takes
<code class="constant">B_SYMBOL_TYPE_TEXT</code> as a parameter to indicate the symbol is a function.
</p><p>
Copy <code class="filename">squarer</code> into a directory
<code class="filename">add-ons</code> that you create in the app's
directory—that's where <code class="function">load_add_on()</code> will look for the add-on. Run the
application, and you'll get the same result. But the important difference
is that you can now load any add-on, and, as long as it respects our
convention (i.e., if it defines a function <code class="code">int squarer(int)</code>), you can
use its services.
</p></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id573825"></a>Library and Add-on Locations?</h3></div></div></div><p>
Where should you put your shared libraries and add-ons? When asked to
load a shared library or an add-on, the system uses an environment
variables in its search: <code class="envar">LIBRARY_PATH</code> (for libraries) and <code class="envar">ADDON_PATH</code> (for
add-ons). Each is a list of paths using a colon (":") as a separator.
</p><p>
<code class="envar">LIBRARY_PATH</code> is set by default to:
</p><pre class="screen">
%A/lib:/boot/home/config/lib:/boot/beos/system/lib
</pre><p>
Where %A is means the app directory. You see now why we have put the
shared library "squarer" in a directory named <code class="filename">lib/</code>.
</p><p>
As for which branch of the search path to put your library in, the
convention is the following:
</p><ul class="itemizedlist"><li><p>
If the library is application specific, put it in <code class="filename">%A/lib</code>.
</p></li><li><p>
If it can be of some use to applications from other third parties,
put it in <code class="filename">/boot/home/config/lib</code>.
</p></li><li><p>
DON'T put it in <code class="filename">/boot/beos/system/lib</code>.
This directory is reserved for system libraries.
</p></li></ul><p>
Note an interesting use of the <code class="filename">%A/lib</code>
directory. If you ship some
application on a CD that relies on a certain version of the system
libraries (libroot.so and libbe.so for example), you can very well
include those on the CD in that <code class="filename">%A/lib</code> directory. They will automatically
override the libraries in <code class="filename">/boot/beos/system/lib</code> for your application, but
not for other applications. This way, you can be sure that your
application will run, no matter what version of the system software is
currently installed on the user's machine, and it won't mess up the rest
of the system. No more installation nightmares.
</p><p>
In a similar manner, <code class="envar">ADDON_PATH</code> is set by default to:
</p><pre class="screen">
%A/add-ons:/boot/home/config/add-ons:/boot/beos/system/add-ons
</pre><p>
The "branch" rules are the same as with libraries:
</p><ul class="itemizedlist"><li><p>
An application-specific add-on should be put in <code class="filename">%A/add-ons</code>.
</p></li><li><p>
An add-on that's intended to be shared by different applications
would end up in <code class="filename">/boot/home/config/add-ons</code>.
</p></li><li><p>
<code class="filename">/boot/beos/system/add-ons</code> is reserved for system add-ons.
</p></li></ul><p>
Also note that you can use symbolic links in combination with the <code class="filename">%A/lib</code>
or <code class="filename">%A/add-ons</code> directories. %A refers to the directory of the real
(resolved) application, not of the link. For example:
</p><p>
<code class="filename">/boot/home/fred</code> is a symbolic
link to <code class="filename">/boot/apps/myapps/fred</code>; when
<code class="filename">/boot/home/fred</code> is launched, %A refers to
<code class="filename">/boot/apps/myapps</code>. This makes
it possible to hide the <code class="filename">lib/</code> and
<code class="filename">add-ons/</code> directories from the user.
</p></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574051"></a>Conclusion</h3></div></div></div><p>
Only your imagination limits what you can do with libraries and add-ons.
We at Be have been using them quite a bit in interesting manners. But we
count on you to get the best out of them and invent other powerful uses.
</p></div></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Engineering2-28-2"></a>Be Engineering Insights: UTF-8 For The BeOS</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Hiroshi</span> <span class="surname">Lockheimer</span></span></div></div></div><p>
By now I'm sure you've heard of UTF-8, the character encoding method of
choice for the BeOS. (Take a look at the article "Unicode UTF-8" by Don
Larkin, found in Issue 75 of the Be Newsletter if you are unfamiliar with
UTF-8.) Given that text is something every developer deals with in their
work in one form or another, I thought I would share some of my UTF-8-ish
experiences with you, mostly in the form of tips, clarifications on
common misconceptions, and some deep confessions of my own.
</p><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574111"></a>strlen(), Byte-length, and Character-length</h3></div></div></div><p>
This is probably the first question that crosses a developer's mind, even
if you're developing in FORTRAN: how does <code class="function">strlen()</code> work with UTF-8 text?
Well, it's simple, <code class="function">strlen()</code> counts the number of bytes in a string until
it encounters a null-terminator (a byte with a value of 0). Since UTF-8
is backwards compatible with plain old ASCII, a null-character is still a
null-character is still a null-character. So, that's that: <code class="function">strlen()</code> will
still work as expected with UTF-8. That is, it will return the number of
bytes, not the number of characters (or glyphs) in your string.
</p><p>
In a multibyte encoding method such as UTF-8, a byte-count is different
from a count of characters (which, incidentally, is why the function
<code class="methodname">BTextView::SetMaxChars()</code> was renamed to
<code class="methodname">BTextView::SetMaxBytes()</code>). This
might seem strange (or even bad) at first, but it's actually a good
thing. After all, <code class="function">malloc()</code> could care less how many instances of Japanese
characters there are in a string when you're trying to allocate some
memory into which to copy it.
</p><p>
What if you want to know how many bytes a character is, so that the
number of characters in a string can be calculated? First of all, you
should consider carefully whether it is indeed necessary for you to know
this information. Again, functions such as <code class="function">strchr()</code>,
<code class="function">strcpy()</code>, <code class="function">strlen()</code>,
and <code class="function">strstr()</code> work as-is with UTF-8. (This is true not only for the BeOS,
but for UTF-8 text processing in general.)
</p><p>
Byte-lengths of characters are an issue only if there is potential for
something to clobber portions of a multibyte character. For example, a
text engine needs to be aware of a character's length so that it knows
how many bytes to traverse when the user moves the insertion point.
</p><p>
OK, you're convinced that you need to know how to measure a character's
length. One approach is to simply iterate through the bytes, counting
from one initial byte to another. Another more exciting approach,
however, is to use Pierre's Uber-inline:
</p><pre class="programlisting c">
inline <span class="type">uint32</span>
<code class="function">utf8_char_len</code>(<span class="type">uchar</span> <code class="parameter">byte</code>)
{
  return (((0xE5000000 &gt;&gt; ((<code class="parameter">byte</code> &gt;&gt; 3) &amp; 0x1E)) &amp; 3) + 1);
}
</pre><p>
When given an initial UTF-8 byte, the above inline will tell you the
number of bytes (from 1 to 4) in the character that the initial byte
represents. It's a hairy inline, and, to be honest (here's the confession
part), I'm not so sure I could explain how it works...it just does. Keep
in mind that the inline looks only at the initial byte of the character,
and therefore does not verify that the following bytes actually make any
sense when construed as a UTF-8 character.
</p><p>
So, with the help of Pierre's inline, you could count the number of
characters in a string as follows:
</p><pre class="programlisting c">
<span class="type">uint32</span> <code class="varname">numChars</code> = 0;
for (<span class="type">uint32</span> <code class="varname">i</code> = 0; <code class="varname">string</code>[<code class="varname">i</code>] != '\0'; <code class="varname">numChars</code>++)
  <code class="varname">i</code> += <code class="function">utf8_char_len</code>(<code class="varname">string</code>[<code class="varname">i</code>]);
</pre></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574294"></a>tolower() and Friends</h3></div></div></div><p>
A similar but more subtle issue arises with
functions such as <code class="function">tolower()</code>. Many (if not all) of
the <code class="function">toXXX()</code>/<code class="function">isXXX()</code>
functions in <code class="filename">ctype.h</code> are not UTF-8 aware. They will fail or even munge
your UTF-8 data, so beware. The proper implementations of those functions
require the use of carefully crafted mapping tables. A less accurate, but
often sufficient, implementation is to use those functions only on 7-bit
ASCII data. Something like:
</p><pre class="programlisting c">
inline <span class="type">uchar</span>
<code class="function">utf8_safe_tolower</code>(<span class="type">uchar</span> <code class="parameter">byte</code>)
{
  return ((<code class="parameter">byte</code> &lt; 0x80) ? <code class="function">tolower</code>(<code class="parameter">byte</code>) : <code class="parameter">byte</code>);
}
</pre></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574364"></a>UTF8.h</h3></div></div></div><p>
Take a look at the Support Kit when you receive your copy of the Preview
Release. There are two UTF-8 conversion routines in a new header file
called (surprise!) <code class="filename">UTF8.h</code>.
<code class="function">convert_to_utf8()</code> and <code class="function">convert_from_utf8()</code>
are already documented in The Be Book, look there for more details. Also,
if you simply want to convert some non-UTF-8 files, try out a little tool
called xtou in <code class="filename">/bin</code>. Its usage is pretty straight-forward; do the
following in a shell if you want to convert your ISO 8859-1 document to
UTF-8:
</p><pre class="screen">
$ xtou -f iso1 my_iso1_file
</pre><p>
You can optionally specify the -n option to convert carriage-returns to
newlines (useful for Mac files).
</p></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574412"></a>It Pays to Cache</h3></div></div></div><p>
There is an inherent slowness to synchronous server calls because of the
associated messaging (client to server, then back to client) overhead.
Since <code class="methodname">BFont::StringWidth()</code> (and the
<code class="classname">BView</code> equivalent) relies on the
App_Server for font metrics information, repeated calls to
<code class="methodname">StringWidth()</code>
can be costly. The solution is to cache this information wherever
sensible. For example, if you have an object that draws a line under some
text, it might make sense for you to cache the string's width so as to
avoid the gratuitous calling of <code class="methodname">StringWidth()</code>. Ming tells me that the
price of a float at Fry's is ridiculously cheap these days, so don't be
too shy about equipping your classes with another member variable or two.
</p><p>
If you're writing, say, a text engine or a web browser (read: something
string-width intensive), simply caching a single string's width might not
be what you want. You probably want to be able to find out any string's
width without incurring the messaging overhead each time. Sounds like you
want your own <code class="methodname">StringWidth()</code> function.
</p><p>
I happened to have such a "width buffer" object, and did some profiling
with it. <code class="classname">BStopWatch</code> revealed the potential performance boost of a local
string-width mechanism to be significant. On average, it took a version
of NetPositive that did no caching roughly 530 microseconds to calculate
the various strings (one at a time) in its default page. With caching
enabled, the number went down to 54 microseconds.
</p><p>
I'll save the implementation details of my width buffer class for another
article, but here are some things to remember if you decide to write your
own.
</p><ul class="itemizedlist"><li><p>
Escapements rule. As long as you don't rely on <code class="constant">B_STRING_SPACING</code> mode,
you can store the escapements of the individual characters on a per
font style (and potentially size) basis, and then use those values to
calculate the pixel width of any string. As usual, The Be Book has much
information on this topic, as does Pierre's recent two-part article,
"The New Font Engine, PART 1 and 2" (issues 76 and 77 of the Be
Newsletter).
</p></li><li><p>
Don't assume 256. Remember, we use UTF-8. Creating a statically sized
table of 256 items is not sufficient. Neither is pre-allocating a table
for the entire Unicode code space. I implemented my class using a
simple linear probing hash table.
</p></li><li><p>
Keep App_Server calls to a minimum. The whole point of caching things
locally is to avoid the number of actual App_Server calls. For example,
<code class="methodname">BFont::GetEscapements()</code> allows for multiple characters to be measured
per call. Every call counts.
</p></li></ul><p>
That's it! Hope you get to know and love UTF-8 as much as Ron and I do.
</p></div></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="News2-28"></a>News From The Front</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">William</span> <span class="surname">Adams</span></span></div></div></div><p>
Isn't it funny how humans are prone to analogy. For some reason it helps
to say "It tastes like chicken" in order to relate the flavor of new
foods to that of known foods. It's kind of like using a club to simulate
the use of a hammer. So what analogy can be used to describe a new OS,
its attendant release, and its expected acceptance in a new community?
It's kind of like giving water to someone who's thirsty in the middle of
the desert. It's like a dragster on steroids that only weighs 20 pounds.
It's kind of like the day I went to junior high and discovered the
opposite sex.
</p><p>
We've completed the Preview Release, and it has begun its irrevocable
trip into history. Disks are pressed, packaged, sealed, and soon to be
delivered, but wait, there's a typo...
</p><p>
You wouldn't believe what a relief it is to get something like this out
the door. It's kind of like passing a stone, or doing yoga. It hurts
while you're doing it, but you're so much better off when you stop. When
you finally get the Preview Release in your hands, a few things in your
life will change.
</p><p>
You will no longer need to gunzip .tgz files, because we will pack all of
our things using zip. You will be able to send embedded forms based mail
to us using a nifty third-party mail program. Your applications will
stand a strong chance of being binary compatible with future releases.
Your applications will have an audience to play to numbering in the few
hundreds of thousands. Your will come into a lot of money and live a long
prosperous life.
</p><p>
But wait, before you go, I quietly released a new version of the PCIList
application
</p><p>
ftp://ftp.be.com/pub/dr9/samples/pciviewer.tgz
</p><p>
It fixes one particular bug whereby if you had multiple PCI cards of the
same variety, only the first one was reported in the list, and the size
of the registers was reported as kilobytes, but the number was actually
HEX kilobytes.
</p><p>
What good is that app again? It's kind of the peephole at the
construction site. You can kind of see what's in your system, but you
can't touch anything. When you're trying to write PCI device drivers, it
becomes useful.
</p><p>
What a weekend!
</p><p>
I was torturing my BeBox trying to do wicked things with television input
and just generally tempting fate with my disk drive when I came across
this thought, "what's a good analogy for how different it is to program
other OSes compared to the BeOS." Then, conveniently, I went kayaking.
</p><p>
When you're kayaking, there is a subtlety of style that makes the
paddling a lot easier. Your sitting flat on your bottom, and you simply
twist your torso left to right, dipping you paddle in on either side and
giving a stroke before lifting it out again. If you force it and try to
do a Hawaii 5-0 type of brute force stroking, you might go faster for a
short amount of time, but in the end, you'll just get tired and not
really have a good time, you'll end up sore, and you won't go back in the
water for a long time.
</p><p>
The BeOS is subtle and elegant. Whereas others have come up with designs
such as OpenDoc, we have Replicants. Where others have come up with
chants at bull fights, we have the BMessage object and SendMessage. Our
strokes are supple, smooth and light. I don't know about you, but I
prefer the long game.
</p><p>
Geoff Woodcock had an incident at a local restaurant recently that's just
too funny to pass by, but I'll save it for next time. But to give you a
hint, it's kind of like the ultimate in embarrassing moments.
</p><p>
Go forth and code! The Preview Release approacheth and the time has come
to stand and deliver. I'm doing it, your friends are doing it, and soon
the whole world be doing it!!
</p></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Gassee2-28"></a>I Like Apple So Much I Want Two of Them</h2></div><div xmlns:d="http://docbook.org/ns/docbook"><span xmlns="http://www.w3.org/1999/xhtml" class="author">By <span class="firstname">Jean-Louis</span> <span class="surname">Gassée</span></span></div></div></div><p>
Charles De Gaulle, while not known as a jester, had a cruel wit. A
connoisseur of Germany, he obliquely paid his respects to the great
country by saying he loved her so much he wanted two Germanys. That was
cold war humor. The heads of state in Cupertino may be feeling more heat
than cold, but, as you will see, we have a vested interest in a more
successful cure to Apple's problems.
</p><p>
Let's focus on the problem du jour: Finding a new CEO for Apple. The
latest coup is business as usual in the Hall of Mirrors. Think back 14
years:
</p><ul class="itemizedlist"><li><p>
Steve Jobs hires Sculley to help him run the company, John pops Steve.
</p></li><li><p>
To help him at the helm, Sculley airlifts Spindler from Europe and
makes him COO and President. Spindler replaces Sculley.
</p></li><li><p>
Spindler restructures Apple's Board of Directors and brings in Amelio
from National Semiconductor. Amelio bounces Spindler.
</p></li><li><p>
A few months later, Amelio buys NeXT and hires Steve as a "Strategic
Advisor." Jobs ousts Amelio.
</p></li></ul><p>
Da capo? Another spin around the dance floor, Nellie? Unhappily, not
quite. The patterns emerge and the names are the same, but the orchestra
is packing up and the chairs are on the tables.
</p><p>
When Jobs hired Sculley, the company was on the way up. Today, it's
losing customers, developers, money, and market share. (And Bill '95
isn't just a greenhorn angling for a license to the Mac look-and-feel.)
Who wants to run Apple under these conditions—where's the Lee Iacocca
of the personal computer industry? Simply wanting the job (so the joke
goes) disqualifies you. The Jim Barksdales are too happy, too rich and,
some say, too smart to consider it.
</p><p>
Apple doesn't need a CEO, they need a messiah (or a crash test dummy).
And any problem that requires walking on water as a solution is, you'll
grant me, a problem ill-stated. Still, there may be a way to make the
search for a new CEO easier. That's where General De Gaulle comes in...
</p><p>
Split Apple into two companies, one for hardware, the other for system
software and applications:
</p><ul class="itemizedlist"><li><p>
Apple, the hardware company, makes Macintosh computers and (why not?)
PC clones.
</p></li><li><p>
Apple, the software company, makes system software (Mac OS on PPC,
and Rhapsody on PPC and Intel) licensed to all comers and cloners, and
applications on PPC and Intel as Claris already does.
</p></li></ul><p>
I realize this involves convincing shareholders, perhaps with terms
involving a temporary reduction of their stake in order to attract new
investors or new lenders. But taking this new course will generate more
excitement (if less blood lust) than backing up the car and running it
into the wall again with a new driver.
</p><p>
Instead of requiring superhuman skills of its new CEOs, the restructured
Apple merely requires skill, courage, and hard work. And we have examples
of these already in the industry. Does the hardware company sounds like
Power Computing? Then merge it with Power or hire Steve Khang. On the
software side, Guerrino De Luca was happily and successfully running
Claris before valiantly signing up for the only job more dangerous than
the CEO position at Apple: VP of Marketing. Make Guerrino CEO of
"AppleSoft" and watch more cloners come back into the Mac space, thus
reversing the market share slide.
</p><p>
Our interest in this is fairly obvious. We've always hoped for a level
playing field for all Mac hardware manufacturers. Disentangling Apple's
hardware from its system software would make everyone's life—ours
included—much easier. In theory, CHRP offers an industry standard
platform, the PC/AT for the PowerPC. But in practice, Apple appears to
want to keep an "enhanced" version of CHRP for itself, in order to
"de-clone" some combination of hardware and software features. Apple has
tried to have its cloners and eat their lunch, too. It's not working;
nobody's happy. This does not sound like a level playing field.
</p><p>
What other choices does Apple have? Many observers think an acquisition
is likely; they even diagnose the recent upswing in AAPL as the result of
traders betting on a sale. One Silicon Valley wag even speculates that
Apple's Board of Directors gave Steve Jobs an expanded role in
anticipation of the deed. After all, who better than Steve to charm a
prospect into buying Apple at an interesting price?
</p><p>
Fair or not, such witticisms serve to emphasize the sentiment that
Apple's current business formula must be revised, or else. We all hope --
for sentimental as well as business reasons—that Apple(s) will emerge
from the current crisis and regain the health and the vibrancy that made
it such a unique icon of Silicon Valley technology and creativity.
</p></div><hr class="pagebreak" /><div class="sect1"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BeDevTalk2-28"></a>BeDevTalk Summary</h2></div></div></div><p>
BeDevTalk is an unmonitored discussion group in which technical
information is shared by Be developers and interested parties. In this
column, we summarize some of the active threads, listed by their subject
lines as they appear, verbatim, in the mail.
</p><p>
To subscribe to BeDevTalk, visit the mailing list page on our web site:
http://www.be.com/aboutbe/mailinglists.html.
</p><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574844"></a>WEEK 2</h3></div></div></div><div class="sect3"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574850"></a>Subject: Dumb sound question</h4></div></div></div><p>
It was suggested, last week, that peak collisions (when mixing sound
sources) are rare. This week, James McCartney pointed out that this
isn't necessarily so (or not necessarily not so)...
</p><p>
“<span class="quote">On the contrary, if you have two signals of different frequency then
their peaks are guaranteed to coincide at regular intervals.</span>”
</p><p>
Other suggestions: The Media Kit should provide a graph of subscribers,
rather than a simple chain. Also, it would be nice if the "native"
sound stream format were floating-point. Mixing floating-point samples
and then converting to 16-bit integers at the end of the stream is not
only "saner" (in that it's much easier to handle overflow—including
deferred handling), the floating-point multiply/add is also faster than
the integer multiply/add. Simple filtering and other manipulations (AM,
for example) is, therefore, faster in floating-point. Of course, you
pay the price in increased data.
</p><p>
THE BE LINE: At the DAC stream level, the subscribers need to speak in
a format that's understood by the hardware, so don't look for mixing or
floating-point-friendly features at that level. But a friendlier,
higher-level graph is being considered as an improvement to the Media
Kit.
</p></div><div class="sect3"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574886"></a>Subject: Detecting Double-clicks...</h4></div></div></div><p>
Should an OS be expected to detect and report double-clicks? If so, how
would an app express the criteria for judging two clicks as part of a
double, as opposed to being two separate events? Obviously, some cases
defy OS-ification: A view that displays multiple clickable items has to
parse clicks on its own, for example.
</p><p>
It was generally agreed that a simple formula such as "two clicks
within a certain (small) amount of time, regardless of mouse's location
=&gt; a double-click" is wrong. The formula is better if you throw in some
location constraint ("...within a certain amount of time, and within
the same 'item'..."), but it's still not going to cover every case.
</p><p>
It was somewhat agreed that certain Be objects (list view items, for
example) can/should implement their own double-click testing.
</p></div></div><div class="sect2"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574920"></a>NEW</h3></div></div></div><div class="sect3"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574926"></a>Subject: So what would smart sound look like?</h4></div></div></div><p>
This thread, which branched off of the "dumb sound" thread, discussed
sound recording and processing in general (i.e., without special regard
for the BeOS): Are delay buffers necessary? Are they expensive?
</p><p>
In a multi-source recording or playback what entity
assigns/synchronizes timestamps? Is 44.1 kHz floating-point a
reasonable trade-off between fidelity and data width? What happened to
a-law and mu-law? And so on.
</p></div><div class="sect3"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574948"></a>Subject: Threads and Fork (again)</h4></div></div></div><p>
What's the real story on <code class="function">spawn_thread()</code> and <code class="function">fork()</code>? Are they
incompatible (as the Be Book claims), or can you mix the two?
</p><p>
THE BE LINE: As Dominic Giampaolo explained, while it *is* possible to
<code class="function">fork()</code> and then call <code class="function">spawn_thread()</code>,
it's not a good idea. The Be Book
is perhaps a bit extreme in its estimation of the consequences of such
an act, but it's correct in its proscription.
</p></div><div class="sect3"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="id574983"></a>Subject: Tracking the mouse inside a view</h4></div></div></div><p>
What's the best way to track the mouse while the user is moving it
around inside a view? Although you certainly don't want to lock down
the entire window, you probably want to be able to generate some sort
of feedback. This thread discussed a couple of ways to safely watch the
mouse and still be able to draw.
</p></div></div></div></div><div id="footer"><hr /><div id="footerT">Prev: <a href="Issue2-27.html">Issue 2-27, July 9, 1997</a>  Up: <a href="volume2.html">Volume 2: 1997</a>  Next: <a href="Issue2-29.html">Issue 2-29, July 23, 1997</a> </div><div id="footerB"><div id="footerBL"><a href="Issue2-27.html" title="Issue 2-27, July 9, 1997"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a href="volume2.html" title="Volume 2: 1997"><img src="./images/navigation/up.png" alt="Up" /></a> <a href="Issue2-29.html" title="Issue 2-29, July 23, 1997"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="footerBR"><div><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div></div><div id="footerBC"><a href="http://www.access-company.com/home.html" title="ACCESS Co."><img alt="Access Company" src="./images/access_logo.png" /></a></div></div></div><div id="licenseFooter"><div id="licenseFooterBL"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="Creative Commons License"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a></div><div id="licenseFooterBR"><a href="./LegalNotice.html">Legal Notice</a></div><div id="licenseFooterBC"><span id="licenseText">This work is licensed under a
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative
          Commons Attribution-Non commercial-No Derivative Works 3.0 License</a>.</span></div></div></body></html>
